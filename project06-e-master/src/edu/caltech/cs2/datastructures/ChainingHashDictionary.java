package edu.caltech.cs2.datastructures;

import edu.caltech.cs2.interfaces.ICollection;
import edu.caltech.cs2.interfaces.IDeque;
import edu.caltech.cs2.interfaces.IDictionary;
import edu.caltech.cs2.interfaces.IQueue;

import java.util.Iterator;
import java.util.function.Supplier;
import java.util.stream.Stream;

public class ChainingHashDictionary<K, V> implements IDictionary<K, V> {
    private Supplier<IDictionary<K, V>> chain;
    private Object [] hashTable;
    private int [] sizes = {100057,100207,100237,100267,100297,100357,100417,100447,100517,100537,100547,100747,100787,100847,100907,100927,100937,100957,100987,101027,101107,101117,101197,101207,101267,101287,101347,101377,101467,101477,101527,101537,101627,101737,101747,101797,101807,101837,101917,101957,101977,101987,102077,102107,102197,102217,102317,102337,102367,102397,102407,102437,102497,102547,102587,102607,102647,102667,102677,102797,102877,102967,103007,103067,103087,103177,103217,103237,103307,103357,103387,103457,103567,103577,103657,103687,103787,103837,103867,103967,103997,104047,104087,104107,104147,104207,104287,104297,104327,104347,104417,104527,104537,104597,104677,104707,104717,104827,104917,104947,104987,105037,105097,105107,105137,105167,105227,105277,105337,105367,105397,105407,105437,105467,105517,105527,105557,105607,105667,105727,105767,105817,105907,105967,105977,105997,106087,106187,106207,106217,106277,106297,106307,106357,106367,106397,106417,106427,106487,106537,106627,106637,106657,106727,106747,106787,106867,106877,106907,106937,106957,107057,107077,107137,107197,107227,107347,107357,107377,107467,107507,107647,107687,107717,107747,107777,107827,107837,107857,107867,107897,107927,108007,108037,108107,108127,108187,108217,108247,108287,108347,108377,108457,108497,108517,108557,108587,108637,108677,108707,108727,108827,108877,108887,108907,108917,108947,108967,109037,109097,109147,109267,109297,109357,109367,109387,109397,109507,109517,109537,109547,109567,109597,109717,109807,109847,109897,109937,109987,110017,110237,110437,110477,110527,110557,110567,110587,110597,110647,110777,110807,110917,110927,110947,110977,111127,111187,111217,111227,111317,111337,111347,111427,111467,111487,111497,111577,111637,111667,111697,111767,111827,111847,111857,111977,111997,112067,112087,112097,112207,112237,112247,112297,112327,112337,112397,112507,112577,112657,112687,112757,112787,112807,112877,112927,112967,112997,113017,113027,113117,113147,113167,113177,113227,113287,113327,113357,113417,113437,113467,113497,113537,113557,113567,113647,113657,113717,113777,113797,113837,113947,113957,114067,114077,114157,114167,114197,114217,114277,114377,114407,114467,114487,114547,114577,114617,114757,114797,114827,114847,114967,114997,115057,115067,115117,115127,115237,115327,115337,115547,115597,115637,115657,115727,115757,115777,115807,115837,115877,115987,116027,116047,116107,116167,116177,116257,116387,116437,116447,116507,116537,116657,116687,116707,116747,116797,116827,116867,116927,117017,117037,117127,117167,117307,117427,117437,117497,117517,117577,117617,117727,117757,117787,117797,117877,117917,117937,117977,118037,118057,118127,118147,118247,118277,118297,118387,118457,118687,118717,118747,118757,118787,118897,118907,118927,118967,119027,119047,119057,119087,119107,119227,119237,119267,119297,119417,119447,119557,119617,119627,119657,119677,119687,119737,119747,119797,119827,120017,120047,120067,120077,120097,120157,120167,120247,120277,120397,120427,120557,120577,120587,120607,120647,120677,120737,120767,120817,120847,120877,120907,120917,120937,120947,120977,120997,121007,121067,121157,121267,121327,121357,121367,121447,121487,121507,121547,121577,121607,121637,121687,121697,121727,121787,121867,121937,121967,121997,122027,122117,122147,122167,122207,122267,122327,122347,122387,122477,122497,122527,122557,122597,122777,122827,122867,122887,122957,123007,123017,123077,123127,123217,123307,123377,123397,123407,123427,123457,123517,123527,123547,123637,123667,123677,123707,123727,123737,123757,123787,123817,123887,123997,124067,124087,124097,124147,124247,124277,124297,124337,124367,124427,124447,124477,124567,124577,124717,124777,124847,124897,124907,124987,125017,125107,125117,125197,125207,125287,125387,125407,125497,125507,125527,125597,125617,125627,125687,125707,125717,125737,125777,125887,125897,125927,126037,126047,126067,126097,126107,126127,126227,126257,126307,126317,126337,126397,126457,126487,126517,126547,126757,126827,126857,126967,127037,127157,127207,127217,127247,127277,127297,127447,127487,127507,127597,127607,127637,127657,127717,127727,127747,127807,127817,127837,127867,127877,127997,128047,128147,128237,128257,128287,128327,128347,128377,128437,128467,128477,128657,128677,128717,128747,128767,128837,128857,128987,129037,129097,129127,129187,129197,129277,129287,129347,129457,129497,129517,129527,129587,129607,129707,129737,129757,129887,129917,129937,129967,130027,130057,130087,130127,130147,130267,130307,130337,130367,130447,130457,130477,130517,130547,130657,130687,130787,130807,130817,130927,130957,130987,131267,131297,131317,131357,131437,131447,131477,131497,131507,131617,131627,131687,131707,131777,131797,131837,131927,131947,132047,132137,132157,132247,132257,132287,132347,132367,132437,132527,132547,132607,132637,132647,132667,132697,132707,132757,132817,132857,132887,132947,132967,133087,133097,133117,133157,133187,133277,133327,133337,133387,133417,133447,133597,133657,133697,133717,133877,133967,134047,134077,134087,134177,134207,134227,134257,134287,134327,134417,134437,134507,134587,134597,134677,134707,134777,134807,134837,134857,134867,134887,134917,134947,135007,135017,135077,135197,135257,135277,135347,135367,135427,135467,135497,135607,135617,135637,135647,135697,135727,135757,135787,135887,135937,135977,136027,136057,136067,136177,136207,136217,136237,136247,136277,136327,136337,136397,136417,136447,136537,136547,136607,136657,136727,136777,136897,136987,137077,137087,137117,137147,137177,137197,137387,137437,137447,137477,137507,137537,137567,137587,137597,137707,137737,137777,137827,137867,137927,137947,137957,138007,138077,138107,138157,138197,138247,138337,138407,138427,138497,138517,138547,138577,138587,138617,138637,138647,138727,138797,138917,138937,138967,138977,139067,139177,139187,139267,139297,139367,139387,139397,139457,139487,139537,139547,139597,139627,139697,139747,139787,139837,139907,139967,139987,140057,140167,140177,140197,140207,140227,140237,140297,140317,140407,140417,140477,140527,140557,140587,140617,140627,140677,140717,140797,140827,140837,140867,140897,140977,141067,141107,141157,141257,141277,141307,141397,141497,141587,141637,141667,141677,141697,141707,141767,141907,141917,141937,142007,142057,142067,142097,142157,142217,142237,142297,142327,142357,142427,142537,142547,142567,142607,142657,142697,142757,142787,142837,142867,142897,142907,143107,143137,143177,143197,143257,143287,143357,143387,143467,143477,143527,143537,143567,143617,143677,143687,143797,143807,143827,143947,143977,144037,144167,144247,144307,144407,144427,144497,144577,144667,144737,144757,144817,144847,144887,144917,144967,145007,145037,145177,145207,145267,145307,145417,145477,145487,145517,145547,145577,145637,145687,145757,145777,145807,145897,145967,145987,146057,146077,146117,146197,146297,146317,146347,146407,146417,146437,146477,146527,146617,146647,146677,146767,146777,146807,146837,146857,146917,146977,146987,147047,147097,147107,147137,147197,147227,147347,147377,147397,147457,147487,147517,147547,147557,147607,147617,147647,147727,147787,147827,147937,147977,147997,148147,148157,148207,148367,148387,148457,148517,148537,148627,148667,148727,148747,148817,148867,148927,148957,148997,149027,149057,149077,149087,149197,149257,149287,149297,149377,149417,149497,149627,149717,149767,149827,149837,149867,150067,150077,150097,150107,150197,150217,150247,150287,150377,150407,150427,150497,150517,150587,150607,150617,150697,150707,150767,150797,150827,150847,150907,150967,151007,151027,151057,151157,151237,151247,151337,151357,151397,151477,151507,151517,151537,151597,151607,151637,151667,151687,151717,151787,151817,151847,151897,151937,151967,152017,152027,152077,152147,152197,152267,152287,152297,152377,152407,152417,152567,152597,152617,152657,152717,152767,152777,152837,152857,152897,152947,153067,153077,153107,153137,153247,153277,153287,153337,153407,153427,153437,153457,153487,153557,153607,153757,153817,153877,153887,153947,153997,154027,154057,154067,154087,154097,154127,154157,154247,154267,154277,154387,154417,154487,154667,154727,154747,154787,154807,154877,154897,154927,154937,155017,155027,155047,155087,155137,155167,155317,155327,155377,155387,155537,155557,155627,155657,155707,155717,155747,155777,155797,155887,156007,156127,156157,156217,156227,156257,156307,156347,156437,156467,156487,156577,156677,156707,156727,156797,156817,156887,156967,157007,157037,157057,157127,157177,157207,157217,157247,157277,157307,157327,157427,157457,157477,157627,157637,157667,157747,157837,157867,157877,157897,157907,158017,158047,158077,158227,158357,158407,158507,158527,158537,158567,158597,158617,158647,158657,158747,158777,158867,158927,159017,159097,159157,159167,159227,159287,159337,159347,159407,159437,159457,159617,159667,159697,159707,159737,159787,159857,159937,159977,160087,160117,160207,160217,160357,160367,160387,160397,160507,160627,160637,160687,160697,160757,160807,160817,160877,160907,160967,160997,161017,161047,161087,161137,161167,161237,161267,161377,161387,161407,161507,161527,161627,161717,161807,161947,161957,161977,162007,162017,162257,162277,162287,162457,162517,162527,162557,162577,162677,162727,162787,162847,162907,162917,162937,162947,162997,163027,163117,163127,163147,163307,163327,163337,163367,163417,163477,163487,163517,163567,163627,163637,163697,163847,163927,163987,163997,164057,164117,164147,164267,164357,164377,164387,164447,164477,164587,164617,164627,164677,164707,164767,164837,164987,165037,165047,165247,165287,165317,165367,165397,165437,165457,165527,165587,165617,165667,165707,165817,165857,165877,165887,165947,166027,166147,166157,166207,166237,166247,166297,166357,166417,166457,166487,166567,166597,166627,166657,166667,166807,166847,166867,166967,166987,167017,167047,167077,167087,167107,167117,167177,167197,167267,167317,167407,167437,167537,167597,167627,167677,167747,167777,167887,167917,167987,168037,168067,168127,168197,168227,168247,168277,168347,168457,168527,168617,168677,168697,168737,168887,168937,168977,169007,169067,169097,169177,169217,169307,169327,169427,169457,169567,169607,169627,169657,169667,169777,169817,169837,169937,169957,169987,170047,170057,170167,170197,170207,170227,170267,170327,170347,170447,170497,170537,170557,170627,170647,170707,170767,170777,170827,170837,170857,170887,170927,170957,171007,171047,171077,171167,171317,171427,171467,171517,171617,171637,171697,171707,171757,171827,171877,171917,171937,171947,172027,172097,172127,172147,172157,172217,172297,172307,172357,172427,172507,172517,172597,172607,172657,172687,172717,172787,172807,172867,172877,172987,173087,173137,173177,173207,173267,173297,173347,173357,173497,173617,173647,173687,173707,173777,173807,173827,173867,173897,173917,173977,174007,174017,174047,174067,174077,174137,174157,174197,174257,174337,174347,174367,174407,174457,174467,174487,174527,174617,174637,174737,174767,174877,174907,174917,175067,175267,175277,175327,175447,175687,175727,175757,175837,175897,175937,176017,176047,176087,176207,176227,176237,176317,176327,176347,176357,176417,176467,176497,176507,176537,176557,176597,176677,176747,176777,176797,176807,176857,176887,176927,176977,177007,177127,177167,177217,177257,177337,177347,177427,177467,177487,177647,177677,177787,177797,177887,177907,177917,177967,178037,178067,178117,178127,178187,178207,178247,178307,178327,178397,178417,178447,178487,178537,178567,178597,178627,178697,178757,178807,178817,178877,178897,178907,178987,179057,179107,179167,179287,179317,179327,179357,179407,179437,179497,179527,179657,179687,179717,179737,179807,179827,179897,179917,179947,179957,180007,180077,180097,180137,180247,180287,180307,180317,180337,180347,180437,180497,180547,180617,180647,180667,180797,180847,180907,181087,181157,181277,181297,181387,181397,181457,181537,181607,181667,181717,181757,181777,181787,181837,181927,181957,181967,181997,182027,182047,182057,182107,182167,182177,182297,182387,182417,182467,182537,182587,182617,182627,182657,182687,182747,182857,182867,182887,182927,182957,183037,183047,183067,183167,183247,183307,183317,183377,183397,183437,183487,183497,183527,183577,183587,183637,183697,183707,183797,183877,183907,183917,184007,184057,184087,184117,184157,184187,184337,184417,184447,184477,184487,184517,184567,184577,184607,184627,184687,184727,184777,184837,184957,184967,184997,185027,185057,185077,185137,185167,185177,185267,185327,185467,185477,185527,185557,185567,185677,185707,185737,185747,185767,185797,185897,185917,185947,185957,185987,186007,186037,186097,186107,186157,186187,186227,186247,186317,186377,186397,186437,186587,186647,186707,186727,186757,186877,186917,186947,187027,187067,187127,187177,187217,187237,187277,187337,187367,187387,187417,187477,187507,187547,187597,187637,187687,187787,187877,187897,187907,187927,187987,188017,188107,188137,188147,188197,188317,188407,188417,188437,188527,188677,188687,188707,188767,188827,188857,188927,188957,189017,189067,189127,189187,189257,189307,189337,189347,189377,189407,189437,189467,189517,189547,189617,189697,189757,189767,189797,189817,189877,189887,189947,189967,189977,189997,190027,190097,190147,190207,190297,190357,190367,190387,190507,190537,190577,190607,190657,190667,190717,190787,190807,190837,190997,191027,191047,191057,191137,191227,191237,191297,191447,191467,191497,191507,191537,191627,191657,191677,191707,191717,191747,191827,191837,191977,192007,192037,192047,192097,192187,192307,192317,192347,192377,192407,192497,192547,192557,192587,192617,192637,192667,192677,192697,192737,192757,192767,192817,192847,192877,192887,192917,192977,193057,193147,193247,193327,193337,193357,193367,193387,193447,193507,193577,193597,193607,193727,193757,193847,193877,193937,193957,194017,194027,194057,194087,194167,194197,194267,194377,194507,194527,194647,194687,194707,194717,194767,194827,194867,194917,194977,195047,195077,195127,195137,195157,195197,195277,195407,195427,195457,195497,195527,195677,195697,195737,195787,195817,195887,195907,195967,195977,195997,196087,196117,196177,196187,196247,196277,196307,196337,196387,196477,196597,196657,196687,196717,196727,196817,196837,196907,196927,197077,197117,197137,197147,197207,197257,197297,197347,197507,197567,197597,197647,197677,197767,197807,197837,197887,197927,197947,197957,198017,198047,198097,198127,198197,198257,198277,198337,198347,198377,198397,198427,198437,198637,198647,198817,198827,198937,198967,198977,198997,199037,199207,199247,199267,199337,199357,199417,199447,199457,199487,199567,199637,199657,199687,199697,199777,199807,199877,199967,200017,200087,200117,200177,200227,200237,200257,200297,200357,200407,200437,200467,200587,200597,200657,200797,200807,200867,200927,200987,201007,201037,201107,201167,201247,201287,201307,201337,201437,201497,201517,201547,201557,201577,201667,201757,201767,201787,201797,201827,201847,201907,201937,201947,201997,202067,202087,202127,202187,202277,202327,202357,202387,202567,202577,202627,202637,202667,202717,202747,202757,202777,202817,202877,202907,202967,202987,203017,203057,203117,203207,203227,203317,203387,203417,203617,203627,203657,203767,203807,203857,203897,203947,203977,204007,204047,204067,204107,204137,204367,204377,204397,204427,204437,204487,204517,204557,204587,204667,204707,204797,204857,204887,204917,204947,205097,205157,205187,205237,205267,205297,205307,205327,205357,205397,205417,205427,205477,205487,205507,205537,205607,205627,205657,205817,205837,205847,205937,205957,205967,206027,206047,206077,206177,206197,206237,206347,206407,206447,206467,206477,206527,206597,206627,206807,206827,206887,206897,206917,207017,207037,207127,207187,207197,207227,207257,207287,207307,207367,207377,207457,207497,207517,207547,207797,207847,207877,207947,207967,207997,208037,208057,208067,208147,208207,208217,208277,208337,208367,208387,208457,208577,208627,208657,208667,208687,208697,208787,208807,208837,208877,208907,208927,208997,209147,209227,209257,209267,209317,209327,209347,209357,209477,209497,209567,209597,209647,209687,209707,209717,209767,209837,209857,209887,209917,209927,209977,209987,210037,210097,210127,210157,210187,210247,210257,210277,210317,210347,210407,210437,210467,210487,210527,210557,210827,210857,210907,210967,211007,211067,211097,211177,211187,211217,211247,211297,211427,211457,211507,211597,211657,211727,211747,211777,211817,211867,211877,211927,211997,212057,212117,212167,212207,212227,212297,212437,212447,212467,212507,212557,212587,212627,212677,212777,212827,212837,212867,212897,212917,212987,213067,213097,213217,213247,213287,213307,213337,213397,213407,213467,213557,213637,213727,213737,213827,213847,213887,213947,213977,214007,214087,214147,214177,214237,214297,214457,214507,214517,214607,214657,214667,214787,214807,214817,214867,214967,214987,215077,215087,215197,215297,215317,215417,215447,215497,215507,215587,215617,215687,215737,215767,215797,215827,215857,215927,216037,216107,216127,216157,216217,216317,216347,216397,216577,216607,216617,216647,216757,216787,216877,216917,216947,216967,217027,217057,217117,217157,217207,217307,217337,217367,217387,217397,217457,217517,217577,217667,217687,217697,217717,217727,217747,217907,217937,218047,218077,218087,218107,218117,218137,218227,218287,218357,218417,218437,218447,218527,218627,218657,218677,218717,218737,218797,218857,218887,218947,218987,219017,219097,219187,219217,219277,219377,219407,219437,219467,219517,219547,219577,219587,219607,219647,219677,219707,219727,219757,219767,219787,219797,219847,219917,219937,219977,220057,220147,220177,220217,220307,220327,220357,220447,220537,220667,220687,220747,220757,220807,220877,220897,220907,221047,221077,221087,221197,221227,221317,221327,221447,221477,221497,221537,221567,221587,221657,221677,221707,221717,221737,221747,221797,221807,221827,221957,221987,222007,222067,222107,222127,222137,222197,222247,222317,222337,222347,222367,222437,222527,222557,222587,222647,222707,222787,222857,222877,222947,222967,222977,223007,223037,223087,223207,223217,223247,223277,223337,223367,223507,223547,223577,223637,223667,223697,223747,223757,223837,224027,224047,224057,224177,224197,224267,224317,224327,224467,224527,224617,224677,224717,224737,224797,224897,224947,224977,225037,225067,225077,225157,225167,225217,225227,225257,225287,225307,225347,225427,225457,225527,225637,225697,225767,225977,226007,226027,226087,226217,226267,226307,226337,226357,226367,226397,226427,226487,226547,226637,226657,226697,226777,226817,226907,226937,227027,227147,227167,227177,227207,227257,227267,227377,227387,227407,227467,227497,227537,227567,227597,227627,227707,227797,227827,227947,227977,228077,228097,228127,228197,228257,228307,228337,228427,228457,228517,228577,228587,228617,228637,228647,228677,228707,228737,228757,228797,228847,228887,229027,229037,229127,229157,229217,229237,229247,229267,229487,229507,229547,229627,229637,229717,229727,229777,229837,229847,229897,229937,230017,230047,230077,230107,230117,230137,230227,230257,230327,230357,230387,230467,230507,230567,230597,230647,230767,230807,230827,230977,231017,231067,231107,231197,231277,231317,231347,231367,231547,231607,231677,231827,231877,231947,231967,232007,232117,232187,232207,232217,232307,232357,232367,232417,232457,232487,232567,232597,232607,232777,232847,232877,232907,232937,232987,233117,233267,233297,233327,233347,233357,233407,233417,233437,233477,233557,233617,233687,233747,233777,233837,233917,234007,234067,234167,234187,234197,234217,234287,234317,234457,234467,234527,234547,234587,234727,234847,234907,234917,234947,234967,234977,235007,235057,235117,235177,235307,235337,235397,235447,235537,235577,235607,235747,235787,235877,235927,235967,235997,236017,236077,236087,236107,236167,236207,236287,236297,236377,236387,236407,236477,236507,236527,236627,236707,236737,236807,236867,236897,236917,236947,237067,237137,237157,237217,237257,237277,237287,237467,237487,237547,237607,237707,237737,237767,237857,237877,237967,237977,237997,238037,238157,238207,238237,238247,238267,238307,238397,238417,238477,238547,238627,238657,238727,238747,238837,238877,238897,238967,239017,239027,239087,239137,239147,239167,239237,239287,239297,239347,239357,239387,239417,239527,239557,239567,239587,239597,239737,239807,239857,239947,239957,239977,240007,240017,240047,240197,240257,240287,240347,240437,240517,240587,240607,240677,240707,240727,240797,240967,240997,241027,241037,241067,241117,241127,241177,241207,241327,241337,241517,241537,241567,241597,241667,241687,241727,241807,241817,241847,241867,241877,241907,242057,242147,242197,242227,242257,242357,242377,242447,242467,242617,242647,242677,242747,242797,242807,242867,242887,242927,243077,243137,243157,243167,243197,243227,243367,243437,243487,243517,243527,243577,243587,243647,243707,243787,243857,243917,244087,244147,244157,244177,244217,244247,244297,244357,244367,244457,244507,244547,244567,244597,244637,244667,244687,244747,244787,244837,244877,244897,244957,244997,245087,245107,245177,245257,245317,245407,245417,245437,245477,245527,245587,245627,245747,245897,245977,246017,246097,246167,246187,246217,246247,246277,246317,246497,246527,246557,246577,246607,246637,246707,246787,246817,246907,246937,246947,247007,247067,247087,247337,247547,247607,247697,247717,247847,247957,247997,248057,248077,248117,248137,248167,248177,248257,248267,248317,248357,248407,248447,248477,248537,248587,248597,248627,248657,248707,248737,248797,248827,248867,248887,248987,249017,249037,249097,249107,249127,249187,249217,249257,249287,249317,249367,249377,249397,249427,249437,249497,249517,249607,249647,249677,249727,249737,249797,249827,249857,249947,249967,250007,250027,250037,250057,250147,250267,250307,250687,250727,250777,250787,250807,250837,250867,250967,251057,251087,251117,251177,251197,251257,251287,251297,251347,251387,251417,251437,251467,251477,251527,251567,251677,251707,251737,251857,251887,251897,251917,251947,252017,252037,252157,252277,252457,252607,252617,252667,252727,252737,252767,252817,252827,252877,252887,252937,253157,253247,253307,253367,253387,253417,253427,253447,253507,253537,253567,253607,253637,253717,253777,253787,253867,253907,253937,253987,254027,254047,254147,254197,254207,254257,254377,254407,254437,254447,254537,254557,254627,254647,254747,254777,254827,254857,254887,254927,254977,254987,255007,255077,255097,255107,255127,255137,255197,255217,255247,255457,255467,255487,255517,255587,255617,255637,255667,255757,255767,255847,255877,255887,255907,255917,255947,255977,256057,256117,256147,256187,256307,256337,256517,256567,256577,256687,256757,256877,256957,256967,257017,257077,257107,257177,257287,257297,257407,257437,257447,257497,257627,257657,257687,257707,257717,257797,257837,257857,257867,257947,257987,258067,258107,258127,258157,258197,258277,258317,258337,258407,258437,258487,258527,258607,258617,258637,258677,258697,258707,258737,258787,258827,258847,258887,258917,258967,258977,259157,259177,259277,259387,259397,259507,259517,259537,259547,259577,259627,259657,259667,259697,259717,259837,259867,259907,259937,259967,260017,260047,260137,260207,260317,260387,260417,260467,260527,260587,260647,260677,260717,260747,260807,260857,260987,261017,261077,261127,261167,261337,261347,261407,261427,261467,261557,261577,261587,261637,261697,261707,261757,261787,261847,261887,261917,261977,262007,262027,262127,262147,262187,262217,262237,262337,262387,262567,262597,262627,262657,262697,262747,262807,262877,262897,262937,262957,263047,263077,263167,263227,263257,263267,263287,263387,263437,263537,263567,263597,263647,263657,263677,263737,263827,263867,263927,263957,264007,264127,264137,264167,264437,264487,264527,264577,264637,264697,264757,264787,264827,264977,264997,265007,265037,265117,265157,265207,265247,265277,265337,265417,265427,265547,265567,265607,265717,265747,265757,265787,265807,265847,265957,265987,266027,266047,266117,266137,266177,266297,266417,266447,266477,266587,266647,266677,266687,266767,266797,266837,266867,266897,266927,266947,266957,266977,267017,267037,267097,267167,267187,267217,267227,267277,267307,267317,267497,267517,267557,267587,267637,267647,267667,267677,267727,267737,267797,267857,267877,267887,267907,268207,268237,268267,268297,268487,268507,268517,268537,268547,268607,268637,268747,268757,268777,268817,268897,268927,268937,268997,269057,269117,269167,269177,269237,269257,269317,269327,269377,269387,269527,269597,269617,269887,269897,269947,269987,270037,270097,270157,270167,270217,270287,270307,270337,270407,270437,270527,270547,270577,270587,270667,270737,270797,270937,270967,271027,271057,271067,271097,271127,271177,271217,271277,271357,271367,271517,271597,271637,271657,271787,271807,271867,271897,271927,271967,272227,272257,272267,272287,272317,272347,272407,272417,272477,272507,272537,272567,272717,272737,272777,272807,272887,272917,272927,273047,273067,273107,273127,273157,273187,273367,273457,273517,273527,273617,273697,273727,273787,273797,273827,273857,273967,273997,274007,274117,274147,274177,274187,274237,274277,274357,274457,274517,274627,274667,274697,274777,274787,274817,274837,274847,274867,274957,275027,275047,275087,275147,275167,275207,275227,275357,275447,275657,275677,275767,275827,275837,275897,275917,275987,276007,276037,276047,276137,276187,276247,276257,276277,276337,276347,276467,276487,276517,276527,276557,276587,276637,276707,276767,276817,276827,276847,276907,276917,276977,277007,277087,277097,277157,277177,277217,277247,277297,277427,277547,277567,277577,277597,277637,277657,277687,277747,277757,277787,277847,277897,278017,278087,278147,278177,278207,278227,278237,278347,278387,278437,278497,278557,278617,278627,278687,278717,278767,278807,278827,278867,278917,278947,279007,279047,279127,279137,279187,279317,279337,279397,279407,279557,279577,279607,279637,279707,279767,279817,279847,279857,279967,279977,280037,280097,280187,280207,280277,280297,280327,280337,280487,280507,280537,280547,280597,280607,280627,280697,280717,280817,280837,280897,280927,280957,280967,280997,281117,281167,281207,281227,281297,281317,281327,281357,281527,281557,281627,281647,281717,281737,281747,281767,281777,281797,281807,281837,281857,281867,281887,281927,281947,282097,282127,282157,282167,282287,282307,282377,282407,282427,282487,282577,282617,282677,282697,282707,282767,282797,282827,282847,282907,282917,282977,283007,283027,283097,283117,283207,283267,283277,283397,283447,283487,283607,283637,283687,283697,283807,283817,283837,283937,283957,284057,284117,284227,284237,284267,284357,284377,284387,284407,284447,284467,284477,284507,284527,284587,284657,284707,284737,284747,284777,284807,284857,284897,284917,284927,284957,285007,285227,285287,285317,285377,285457,285497,285517,285557,285667,285697,285707,285757,285767,285827,285937,285977,285997,286367,286397,286427,286457,286477,286487,286547,286687,286697,286777,286927,286987,287047,287057,287087,287107,287117,287137,287167,287237,287257,287297,287327,287347,287387,287437,287537,287557,287597,287747,287857,287867,287887,287977,288007,288077,288137,288227,288247,288257,288307,288317,288427,288467,288527,288577,288647,288697,288767,288817,288877,288907,288947,288997,289067,289127,289297,289397,289417,289477,289577,289607,289637,289657,289717,289727,289837,289847,289897,289937,289957,289967,289987,290027,290047,290057,290107,290137,290317,290327,290347,290447,290497,290527,290557,290597,290617,290627,290657,290677,290707,290737,290767,290827,290837,290897,290987,291007,291037,291077,291107,291167,291217,291257,291287,291337,291367,291377,291437,291457,291547,291647,291677,291727,291817,291857,291877,291887,291997,292027,292037,292057,292147,292157,292267,292367,292427,292477,292517,292577,292627,292667,292717,292727,292777,292807,292837,292867,293087,293107,293147,293177,293207,293257,293357,293467,293507,293617,293677,293717,293767,293827,293957,294067,294127,294157,294167,294227,294247,294277,294317,294337,294347,294397,294467,294647,294757,294787,294887,294947,294997,295007,295037,295187,295237,295247,295277,295357,295387,295417,295517,295567,295727,295777,295787,295837,295847,295877,295937,296017,296027,296047,296117,296137,296237,296287,296347,296377,296437,296477,296507,296557,296587,296627,296687,296767,296797,296827,296987,297067,297097,297247,297257,297317,297377,297397,297457,297467,297487,297607,297617,297707,297727,297757,297797,297907,297967,298087,298157,298187,298237,298247,298307,298327,298427,298477,298607,298667,298687,298757,298777,298817,298847,298897,298937,299017,299027,299087,299107,299137,299147,299197,299287,299317,299357,299417,299447,299477,299527,299567,299617,299777,299807,299857,299977,300007,300017,300137,300187,300247,300277,300317,300347,300367,300397,300427,300497,300557,300647,300667,300757,300787,300857,300877,300967,300977,300997,301027,301057,301127,301177,301237,301247,301267,301447,301487,301577,301627,301657,301747,301867,301877,301897,301907,301927,301997,302167,302227,302287,302297,302317,302417,302507,302567,302587,302597,302647,302747,302767,302837,302857,302927,302977,303007,303097,303157,303187,303217,303257,303287,303307,303337,303367,303377,303497,303547,303587,303617,303647,303727,303767,303817,303827,303907,303917,303937,303997,304067,304127,304217,304357,304417,304457,304477,304517,304537,304597,304687,304757,304807,304847,304867,304897,304907,304937,305017,305047,305147,305237,305267,305297,305377,305407,305477,305497,305597,305717,305857,305867,305917,305927,305947,306157,306167,306247,306347,306367,306377,306407,306437,306457,306517,306577,306587,306707,306727,306827,306847,306857,306877,306947,307067,307147,307187,307267,307277,307337,307367,307397,307537,307577,307627,307687,307817,308017,308027,308107,308117,308137,308317,308327,308437,308447,308467,308507,308527,308537,308587,308597,308827,308857,308887,308927,309007,309037,309107,309137,309157,309167,309277,309317,309367,309437,309457,309577,309637,309667,309677,309707,309737,309797,309857,309877,309937,309977,310027,310087,310117,310127,310187,310237,310357,310397,310447,310507,310547,310567,310577,310627,310697,310727,310747,310867,310927,310987,310997,311027,311137,311177,311197,311237,311347,311407,311447,311537,311557,311567,311677,311687,311737,311747,311807,311827,311867,311897,311957,312007,312047,312107,312197,312217,312397,312407,312427,312517,312527,312617,312677,312727,312737,312757,312857,312887,312937,312967,313037,313087,313127,313147,313207,313267,313297,313307,313387,313477,313507,313517,313567,313597,313637,313717,313727,313777,313897,313987,313997,314077,314107,314117,314137,314227,314257,314267,314357,314407,314467,314497,314527,314597,314627,314707,314747,314777,314807,314827,314917,314927,314957,315037,315047,315067,315097,315127,315247,315257,315377,315407,315437,315467,315517,315527,315547,315617,315677,315697,315857,315907,315937,315967,315977,316037,316067,316087,316097,316177,316297,316507,316567,316577,316637,316697,316717,316777,316817,316847,316907,316937,316957,317047,317077,317087,317197,317227,317257,317267,317327,317437,317557,317587,317617,317717,317777,317797,317827,317857,317887,317957,317987,318007,318077,318107,318127,318137,318247,318287,318337,318347,318377,318407,318457,318467,318557,318677,318737,318817,318907,318917,319027,319037,319057,319097,319117,319127,319147,319237,319327,319357,319387,319427,319477,319547,319567,319577,319607,319687,319727,319747,319757,319817,319897,319927,319937,319967,320027,320057,320107,320237,320267,320317,320377,320387,320417,320477,320627,320647,320657,320687,320767,320867,320927,321007,321017,321037,321047,321077,321187,321227,321247,321367,321397,321427,321467,321547,321577,321617,321647,321707,321757,321817,321847,321947,322037,322057,322067,322097,322237,322247,322327,322397,322417,322537,322607,322627,322727,322747,322757,322807,322877,322997,323027,323077,323087,323137,323207,323377,323467,323507,323537,323567,323597,323647,323707,323717,323767,323797,323837,323927,323957,323987,324067,324097,324217,324397,324427,324437,324497,324517,324557,324587,324617,324637,324647,324697,324707,324757,324847,324977,324997,325027,325187,325217,325307,325447,325477,325487,325517,325537,325597,325607,325627,325667,325697,325747,325777,325807,325877,325957,325987,326057,326087,326147,326257,326437,326467,326497,326537,326567,326597,326617,326657,326687,326707,326737,326867,326947,327007,327017,327127,327247,327277,327307,327317,327337,327347,327407,327517,327557,327647,327667,327707,327737,327757,327797,327827,327917,327967,328007,328037,328067,328127,328177,328277,328327,328357,328397,328637,328667,328687,328777,328787,328837,328847,328897,329027,329167,329177,329207,329257,329267,329297,329317,329347,329387,329557,329587,329597,329617,329627,329657,329677,329687,329717,329867,329947,329957,329977,330017,330037,330047,330067,330097,330167,330217,330227,330247,330287,330347,330427,330557,330587,330607,330697,330767,330787,330857,330877,330887,330907,330917,330997,331027,331127,331147,331207,331217,331277,331307,331337,331367,331447,331537,331547,331577,331697,331777,331897,331907,331937,331957,331967,331997,332117,332147,332207,332287,332317,332417,332447,332467,332477,332567,332617,332687,332767,332837,332887,332947,332987,333097,333107,333187,333197,333227,333287,333337,333367,333397,333427,333457,333497,333517,333647,333667,333737,333757,333787,333857,333997,334057,334127,334157,334177,334247,334297,334387,334427,334447,334487,334507,334547,334637,334667,334717,334727,334777,334787,334877,334897,334987,335047,335057,335077,335107,335117,335207,335347,335417,335477,335507,335527,335557,335567,335747,335807,335857,335897,335917,335957,336157,336227,336247,336307,336317,336397,336437,336527,336577,336587,336667,336727,336757,336767,336827,336857,336887,336977,336997,337097,337217,337277,337327,337367,337397,337427,337457,337487,337517,337537,337607,337627,337697,337817,337837,337867,337907,337957,338017,338027,338137,338167,338197,338207,338237,338267,338287,338297,338347,338407,338477,338497,338567,338687,338707,338717,338747,338777,338857,338867,338927,339067,339107,339127,339137,339187,339247,339257,339307,339467,339517,339527,339557,339617,339637,339707,339727,339817,339827,339887,339907,340007,340027,340037,340057,340117,340127,340237,340267,340297,340337,340387,340397,340447,340477,340577,340657,340687,340757,340777,340787,340877,340897,340927,340937,340957,341017,341027,341057,341087,341227,341287,341347,341357,341447,341477,341507,341557,341587,341597,341617,341647,341687,341777,341827,341927,341947,342037,342047,342077,342107,342187,342197,342257,342337,342347,342467,342497,342527,342547,342607,342647,342697,342757,342847,343037,343087,343127,343177,343237,343267,343307,343327,343337,343517,343547,343627,343667,343687,343727,343787,343817,343897,343997,344017,344117,344167,344177,344207,344237,344257,344327,344347,344417,344497,344567,344587,344797,344807,344857,344887,344917,344957,344987,345017,345047,345067,345227,345307,345487,345517,345547,345577,345607,345637,345647,345707,345727,345757,345817,345887,345907,345937,345997,346097,346117,346147,346187,346207,346217,346277,346337,346397,346417,346447,346547,346607,346627,346657,346667,346867,346877,347057,347167,347177,347197,347227,347257,347287,347297,347317,347437,347587,347707,347717,347747,347887,347957,347987,348017,348077,348097,348217,348247,348287,348307,348367,348407,348437,348457,348487,348527,348547,348587,348617,348637,348757,348827,348917,348937,349007,349177,349187,349207,349337,349357,349387,349397,349477,349507,349567,349637,349667,349697,349717,349787,349837,349907,349927,349967,350087,350107,350137,350237,350257,350347,350377,350437,350447,350587,350617,350657,350677,350737,350747,350767,350887,350947,351037,351047,351077,351097,351157,351217,351257,351287,351347,351397,351427,351437,351457,351497,351517,351587,351667,351707,351727,351797,351847,351887,352007,352057,352097,352217,352237,352267,352327,352357,352367,352607,352637,352757,352817,352837,352867,352907,353047,353057,353117,353137,353147,353237,353317,353527,353557,353567,353627,353657,353677,353687,353737,353747,353767,353777,353797,353807,353867,353897,353917,354007,354017,354037,354047,354097,354247,354257,354307,354317,354337,354377,354587,354647,354667,354677,354727,354737,354847,354877,354997,355007,355027,355037,355057,355087,355127,355297,355307,355417,355427,355457,355507,355517,355697,355717,355777,355847,355867,355937,355967,356077,356137,356197,356287,356327,356387,356467,356567,356647,356737,356887,356927,356947,356977,357047,357107,357197,357347,357377,357437,357517,357587,357667,357677,357727,357737,357767,357787,357817,357967,357977,357997,358157,358277,358297,358327,358417,358427,358447,358487,358597,358607,358637,358667,358697,358727,358747,358847,358867,358877,358907,358987,359017,359027,359137,359147,359167,359207,359267,359297,359327,359357,359377,359407,359417,359477,359587,359657,359747,359767,359837,359897,359987,360007,360037,360167,360187,360197,360257,360277,360287,360307,360317,360337,360407,360457,360497,360637,360817,360827,360907,360947,360977,361217,361237,361327,361337,361357,361447,361507,361577,361637,361687,361727,361747,361787,361807,361877,361927,361967,362027,362107,362137,362147,362177,362237,362347,362357,362377,362407,362657,362707,362717,362867,362897,362927,362977,362987,363017,363037,363047,363067,363157,363217,363257,363277,363317,363367,363397,363437,363497,363557,363577,363677,363757,363767,363887,363917,363947,363967,363977,364027,364127,364187,364267,364337,364417,364447,364537,364607,364627,364657,364687,364717,364747,364937,364997,365017,365107,365137,365147,365257,365297,365327,365357,365377,365467,365507,365527,365537,365557,365567,365587,365627,365747,365797,365837,366077,366097,366127,366167,366217,366227,366277,366287,366307,366347,366397,366437,366467,366497,366517,366547,366607,366677,366697,366727,366787,366907,366917,366967,366997,367007,367027,367097,367127,367207,367277,367307,367357,367397,367427,367457,367547,367597,367637,367687,367777,367867,367957,368047,368077,368107,368117,368197,368227,368287,368327,368447,368507,368597,368647,368717,368737,368857,368947,368957,369007,369067,369077,369097,369137,369197,369247,369407,369487,369557,369637,369647,369827,369877,369917,369947,369997,370057,370067,370147,370207,370217,370247,370387,370427,370477,370537,370547,370597,370687,370837,370897,371027,371057,371087,371177,371227,371237,371257,371387,371417,371447,371587,371617,371627,371737,371797,371837,371857,371897,371927,371957,372037,372067,372107,372137,372167,372277,372367,372377,372397,372497,372607,372637,372667,372677,372707,372797,372817,372847,372877,372917,373007,373127,373157,373187,373207,373297,373327,373357,373447,373487,373517,373567,373657,373717,373757,373777,373837,373937,373987,374047,374117,374137,374177,374287,374317,374347,374447,374537,374557,374587,374677,374687,374797,374807,374837,374887,374977,374987,375017,375097,375127,375157,375227,375247,375257,375367,375407,375457,375467,375527,375607,375647,375667,375707,375757,375787,375857,375967,375997,376097,376127,376147,376237,376297,376307,376417,376477,376547,376577,376627,376657,376687,376757,376787,376807,376837,376847,376897,376927,377137,377147,377197,377257,377287,377297,377327,377347,377387,377477,377527,377537,377557,377617,377687,377717,377737,377827,377887,378127,378137,378167,378277,378317,378407,378467,378667,378757,378817,378967,378977,378997,379007,379087,379097,379147,379157,379177,379187,379207,379277,379307,379387,379397,379417,379597,379607,379667,379727,379777,379787,379817,379837,379877,379927,379997,380047,380117,380147,380197,380207,380267,380287,380327,380377,380417,380447,380557,380657,380707,380777,380797,380837,380867,380917,380957,380977,381037,381047,381077,381097,381167,381287,381347,381377,381467,381487,381527,381607,381637,381697,381707,381737,381757,381817,381917,381937,381977,382037,382087,382117,382267,382357,382427,382457,382507,382567,382727,382747,382777,382807,382847,382867,383077,383107,383147,383267,383297,383347,383417,383527,383557,383587,383627,383657,383767,383777,383797,383807,383837,383917,383987,384017,384067,384107,384157,384187,384227,384247,384257,384277,384287,384317,384367,384407,384437,384487,384497,384547,384577,384697,384737,384757,384817,384827,384847,384907,385027,385057,385087,385127,385267,385327,385397,385417,385537,385597,385607,385657,385817,385837,385877,385897,385907,385927,385967,385997,386017,386047,386117,386227,386237,386297,386437,386537,386587,386647,386677,386747,386777,386887,386927,386977,386987,387007,387017,387047,387077,387137,387187,387197,387227,387307,387397,387437,387577,387587,387677,387707,387727,387857,387917,387967,387977,388057,388067,388117,388177,388187,388237,388277,388477,388567,388657,388697,388727,388757,388777,388837,388897,388937,389027,389047,389057,389117,389167,389227,389287,389297,389357,389437,389447,389507,389527,389567,389687,389797,389867,389897,389927,389947,389957,390067,390077,390097,390107,390157,390307,390347,390367,390407,390437,390487,390527,390647,390707,390727,390737,390877,390967,391057,391067,391117,391177,391217,391247,391337,391367,391387,391397,391487,391537,391627,391717,391757,391817,391847,391907,391967,391987,392087,392177,392267,392297,392347,392437,392467,392477,392647,392737,392767,392807,392827,392837,392857,392927,392957,393007,393017,393077,393097,393137,393157,393187,393247,393257,393287,393377,393487,393517,393557,393577,393587,393637,393667,393677,393697,393727,393797,393847,393857,393947,393977,393997,394007,394157,394187,394327,394357,394367,394507,394577,394637,394717,394727,394747,394787,394817,394837,394897,394967,394987,395027,395047,395107,395137,395147,395287,395377,395407,395537,395597,395627,395657,395677,395687,395737,395767,395887,395897,396107,396157,396197,396217,396247,396377,396427,396437,396527,396547,396577,396637,396647,396667,396887,396937,396947,396997,397027,397037,397057,397127,397217,397237,397297,397337,397357,397427,397517,397547,397567,397597,397687,397697,397757,397807,397867,397897,397907,398077,398087,398117,398207,398227,398267,398287,398347,398357,398407,398417,398467,398477,398557,398627,398857,398887,398917,398977,399067,399097,399107,399137,399197,399227,399277,399527,399557,399577,399587,399617,399647,399667,399677,399727,399757,399787,399887,399937};
    private int size;
    private int sizeLen;
    private double load;

    public ChainingHashDictionary(Supplier<IDictionary<K, V>> chain) {
        hashTable = new Object [sizes[0]];
        this.size = 0;
        this.sizeLen = 0;
        this.chain = chain;
        load = 0.5;
    }

    private void resize(){
        sizeLen++;
        Object [] tempHash = new Object[sizes[sizeLen]];
        for(Object o: hashTable){
            if(o != null){
                for(K key: ((IDictionary<K, V>)o).keySet()){
                    int hash = Math.abs(key.hashCode() % tempHash.length);
                    if(tempHash[hash] == null){
                        tempHash[hash] = chain.get();
                    }
                    IDictionary<K, V> ret = (IDictionary<K, V>) tempHash[hash];
                    ret.put(key, ((IDictionary<K, V>)o).get(key));
                }
            }
        }
        hashTable = tempHash;
    }
    /**
     * @param key
     * @return value corresponding to key
     */
    @Override
    public V get(K key) {
        int hash = Math.abs(Math.abs(Math.abs(key.hashCode() % hashTable.length)));
        if(hashTable[hash] == null) {
            return null;
        }
        IDictionary<K, V> temp = (IDictionary<K, V>)hashTable[hash];
        return temp.get(key);
    }

    @Override
    public V remove(K key) {
        int hash = Math.abs(key.hashCode() % hashTable.length);
        IDictionary<K, V> temp = (IDictionary<K, V>)hashTable[hash];
        if(temp == null) {
            return null;
        }
        V val = temp.remove(key);
        if(val != null){
            size--;
        }
        return val;
    }

    @Override
    public V put(K key, V value) {
        if ((double)(size + 1)/hashTable.length > load){
            resize();
        }
        int hash = Math.abs(key.hashCode() % hashTable.length);
        if(hashTable[hash] == null){
            hashTable[hash] = chain.get();
        }
        V val = ((IDictionary<K, V>)hashTable[hash]).get(key);
        if (val == null){
            size++;
        }
        ((IDictionary<K, V>)hashTable[hash]).put(key, value);
        return val;
    }

    @Override
    public boolean containsKey(K key) {
        return get(key) != null;
    }

    /**
     * @param value
     * @return true if the HashDictionary contains a key-value pair with
     * this value, and false otherwise
     */
    @Override
    public boolean containsValue(V value) {
        return values().contains(value);
    }

    /**
     * @return number of key-value pairs in the HashDictionary
     */
    @Override
    public int size() {
        return this.size;
    }

    @Override
    public ICollection<K> keySet() {
        ICollection<K> keys = new LinkedDeque<>();
        for(int i = 0; i < hashTable.length; i++){
            if(hashTable[i] != null){
                IDictionary<K, V> temp = (IDictionary<K, V>)hashTable[i];
                for(K key: temp.keySet()){
                    keys.add(key);
                }
            }
        }
        return keys;
    }

    @Override
    public ICollection<V> values() {
        ICollection<V> values = new LinkedDeque<>();
        for(int i = 0; i < hashTable.length; i++){
            if(hashTable[i] != null){
                IDictionary<K, V> temp = (IDictionary<K, V>)hashTable[i];
                for(V val: temp.values()){
                    values.add(val);
                }
            }
        }
        return values;
    }

    /**
     * @return An iterator for all entries in the HashDictionary
     */
    @Override
    public Iterator<K> iterator() {
        return this.keySet().iterator();
    }

}
